@model Projeto_TCC_2022.Models.ViewModels.EditarAvaliação

<div class="w-50 mx-auto">

    <h3>Avaliar</h3>

    <h5 class="mt-3 mb-3" style="color:#2c2c2c">Serviços</h5>

    @using (Html.BeginForm("Editar", "Avaliação", FormMethod.Post))
    {
        @Html.HiddenFor(Avaliação => Avaliação.Id);

        for (int i = 0; i < Model.Serviços.Count; i++)
        {
            <div class="card mb-3">
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <h6 style="color: #3f3f3f;">Serviço</h6>
                            <h5 class="card-title">@Model.Serviços[i].Nome</h5>
                        </div>
                        <div class="col-md-4">
                            <h6 style="color: #3f3f3f;">Quantidade</h6>
                            <h5 class="card-title">@Model.Itens.Where(e => e.Nome == Model.Serviços[i].Nome).SingleOrDefault().Quantidade</h5>
                        </div>
                        <div class="col-md-4">
                            <h6 style="color: #3f3f3f;">Preço Cobrado</h6>
                            <h5 class="card-title">R$ @Convert.ToDecimal(Model.Itens.Where(e => e.Nome == Model.Serviços[i].Nome).SingleOrDefault().Preço).ToString("F")</h5>
                        </div>
                    </div>
                </div>
                <div class="card-body text-center">
                    <div class="fs-1 estrela-0">
                        <input type="hidden" name="AvItem[@i].Id" value="@Model.AvItem[i].Id" />
                        <input type="hidden" id="ItemAvaliação-@i-Estrelas" name="Estrelas[@i]" value="@Model.AvItem[i].Estrelas">
                        @switch (Model.AvItem[i].Estrelas)
                        {
                            case 0:
                                <text>
                                    <i data-valor="1" data-item="@i" class="bi bi-star d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="2" data-item="@i" class="bi bi-star d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="3" data-item="@i" class="bi bi-star d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="4" data-item="@i" class="bi bi-star d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="5" data-item="@i" class="bi bi-star d-inline-block estrelas estrelas-@i"></i>
                                </text>
                                break;
                            case 1:
                                <text>
                                    <i data-valor="1" data-item="@i" class="bi bi-star-fill d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="2" data-item="@i" class="bi bi-star d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="3" data-item="@i" class="bi bi-star d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="4" data-item="@i" class="bi bi-star d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="5" data-item="@i" class="bi bi-star d-inline-block estrelas estrelas-@i"></i>
                                </text>
                                break;
                            case 2:
                                <text>
                                    <i data-valor="1" data-item="@i" class="bi bi-star-fill d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="2" data-item="@i" class="bi bi-star-fill d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="3" data-item="@i" class="bi bi-star d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="4" data-item="@i" class="bi bi-star d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="5" data-item="@i" class="bi bi-star d-inline-block estrelas estrelas-@i"></i>
                                </text>
                                break;
                            case 3:
                                <text>
                                    <i data-valor="1" data-item="@i" class="bi bi-star-fill d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="2" data-item="@i" class="bi bi-star-fill d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="3" data-item="@i" class="bi bi-star-fill d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="4" data-item="@i" class="bi bi-star d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="5" data-item="@i" class="bi bi-star d-inline-block estrelas estrelas-@i"></i>
                                </text>
                                break;
                            case 4:
                                <text>
                                    <i data-valor="1" data-item="@i" class="bi bi-star-fill d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="2" data-item="@i" class="bi bi-star-fill d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="3" data-item="@i" class="bi bi-star-fill d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="4" data-item="@i" class="bi bi-star-fill d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="5" data-item="@i" class="bi bi-star d-inline-block estrelas estrelas-@i"></i>
                                </text>
                                break;
                            case 5:
                                <text>
                                    <i data-valor="1" data-item="@i" class="bi bi-star-fill d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="2" data-item="@i" class="bi bi-star-fill d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="3" data-item="@i" class="bi bi-star-fill d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="4" data-item="@i" class="bi bi-star-fill d-inline-block estrelas estrelas-@i"></i>
                                    <i data-valor="5" data-item="@i" class="bi bi-star-fill d-inline-block estrelas estrelas-@i"></i>
                                </text>
                                break;
                        }
                    </div>
                </div>
            </div>
            

        }

        <h5 class="mt-4 mb-4">Adicionar uma avaliação escrita</h5>

        <div class="text-center mb-5">
            <textarea rows="5" cols="85" class="textareaAv" placeholder="Conte como foi a sua experiência com a Oficina. O que gostou? O que não gostou?" id="Texto" name="Texto">@Model.Avaliação.Texto</textarea>
        </div>

        <div class="text-center">
            <button type="submit" class="btn btn-success">Enviar</button>
        </div>
    }

</div>


@section scripts{
    <script>
        $(document).ready(function () {
        {
            var x = $(".estrela-0 .estrelas");

            x.click(function () {

                var estrela = $(this);

                estrela.addClass('bi-star-fill')
                estrela.removeClass('bi-star')
                    
                estrela.prevAll().addClass('bi-star-fill');
                estrela.prevAll().removeClass('bi-star');

                estrela.nextAll().removeClass('bi-star-fill');
                estrela.nextAll().addClass('bi-star');

                var valor = estrela.data("valor");
                var index = estrela.data("item");

                $("#ItemAvaliação-" + index + "-Estrelas").val(valor);
            });
        }
    });
    </script>
}